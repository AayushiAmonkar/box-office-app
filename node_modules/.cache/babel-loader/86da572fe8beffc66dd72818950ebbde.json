{"ast":null,"code":"import _objectSpread from\"C:/Users/Aayushi Amonkar/Documents/web development/ReactCourseIntensala/module3/box-office/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/Aayushi Amonkar/Documents/web development/ReactCourseIntensala/module3/box-office/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _toConsumableArray from\"C:/Users/Aayushi Amonkar/Documents/web development/ReactCourseIntensala/module3/box-office/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import{useReducer,useEffect,useState}from\"react\";import{apiGet}from\"./Config.jsx\";function showsReducer(prevState,action){switch(action.type){case\"ADD\":{return[].concat(_toConsumableArray(prevState),[action.showId]);}case\"REMOVE\":{return prevState.filter(function(showId){return showId!==action.showId;});}default:return prevState;}}function usePersistedReducer(reducer,initialState,key){var _useReducer=useReducer(reducer,initialState,function(initial){var persisted=localStorage.getItem(key);return persisted?JSON.parse(persisted):initial;}),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];useEffect(function(){localStorage.setItem(key,JSON.stringify(state));},[state,key]);return[state,dispatch];}export function useShows(){var key=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"shows\";return usePersistedReducer(showsReducer,[],key);}export function useLastQuery(){var key=arguments.length>0&&arguments[0]!==undefined?arguments[0]:\"lastQuery\";var _useState=useState(function(){var persisted=sessionStorage.getItem(key);return persisted?JSON.parse(persisted):\"\";}),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var setPersistedInput=function setPersistedInput(newState){setInput(newState);sessionStorage.setItem(key,JSON.stringify(newState));};return[input,setPersistedInput];}var reducer=function reducer(prevState,action){switch(action.type){case\"FETCH_SUCCESS\":{return{isLoading:false,error:null,show:action.show};}case\"FETCH_FAILED\":{return _objectSpread(_objectSpread({},prevState),{},{isLoading:false,error:action.error});}default:return prevState;}};export function useShow(showId){var _useReducer3=useReducer(reducer,{show:null,isLoading:true,error:null}),_useReducer4=_slicedToArray(_useReducer3,2),state=_useReducer4[0],dispatch=_useReducer4[1];useEffect(function(){var isMounted=true;apiGet(\"/shows/\".concat(showId,\"?embed[]=seasons&embed[]=cast\")).then(function(results){if(isMounted){dispatch({type:\"FETCH_SUCCESS\",show:results});}}).catch(function(err){if(isMounted){dispatch({type:\"FETCH_FAILED\",error:err.message});}});return function(){isMounted=false;};},[showId]);return state;}","map":{"version":3,"names":["useReducer","useEffect","useState","apiGet","showsReducer","prevState","action","type","showId","filter","usePersistedReducer","reducer","initialState","key","initial","persisted","localStorage","getItem","JSON","parse","state","dispatch","setItem","stringify","useShows","useLastQuery","sessionStorage","input","setInput","setPersistedInput","newState","isLoading","error","show","useShow","isMounted","then","results","catch","err","message"],"sources":["C:/Users/Aayushi Amonkar/Documents/web development/ReactCourseIntensala/module3/box-office/src/misc/custom-hooks.js"],"sourcesContent":["import { useReducer, useEffect, useState } from \"react\";\r\nimport { apiGet } from \"./Config.jsx\";\r\nfunction showsReducer(prevState, action) {\r\n  switch (action.type) {\r\n    case \"ADD\": {\r\n      return [...prevState, action.showId];\r\n    }\r\n\r\n    case \"REMOVE\": {\r\n      return prevState.filter((showId) => showId !== action.showId);\r\n    }\r\n\r\n    default:\r\n      return prevState;\r\n  }\r\n}\r\n\r\nfunction usePersistedReducer(reducer, initialState, key) {\r\n  const [state, dispatch] = useReducer(reducer, initialState, (initial) => {\r\n    const persisted = localStorage.getItem(key);\r\n\r\n    return persisted ? JSON.parse(persisted) : initial;\r\n  });\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(key, JSON.stringify(state));\r\n  }, [state, key]);\r\n\r\n  return [state, dispatch];\r\n}\r\n\r\nexport function useShows(key = \"shows\") {\r\n  return usePersistedReducer(showsReducer, [], key);\r\n}\r\n\r\nexport function useLastQuery(key = \"lastQuery\") {\r\n  const [input, setInput] = useState(() => {\r\n    const persisted = sessionStorage.getItem(key);\r\n\r\n    return persisted ? JSON.parse(persisted) : \"\";\r\n  });\r\n\r\n  const setPersistedInput = (newState) => {\r\n    setInput(newState);\r\n    sessionStorage.setItem(key, JSON.stringify(newState));\r\n  };\r\n  return [input, setPersistedInput];\r\n}\r\nconst reducer = (prevState, action) => {\r\n  switch (action.type) {\r\n    case \"FETCH_SUCCESS\": {\r\n      return { isLoading: false, error: null, show: action.show };\r\n    }\r\n\r\n    case \"FETCH_FAILED\": {\r\n      return { ...prevState, isLoading: false, error: action.error };\r\n    }\r\n\r\n    default:\r\n      return prevState;\r\n  }\r\n};\r\nexport function useShow(showId) {\r\n  const [state, dispatch] = useReducer(reducer, {\r\n    show: null,\r\n    isLoading: true,\r\n    error: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    let isMounted = true;\r\n\r\n    apiGet(`/shows/${showId}?embed[]=seasons&embed[]=cast`)\r\n      .then((results) => {\r\n        if (isMounted) {\r\n          dispatch({ type: \"FETCH_SUCCESS\", show: results });\r\n        }\r\n      })\r\n      .catch((err) => {\r\n        if (isMounted) {\r\n          dispatch({ type: \"FETCH_FAILED\", error: err.message });\r\n        }\r\n      });\r\n\r\n    return () => {\r\n      isMounted = false;\r\n    };\r\n  }, [showId]);\r\n\r\n  return state;\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}